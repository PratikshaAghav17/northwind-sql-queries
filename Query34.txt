34. Find the customers who have ordered products from all categories
SELECT Customers.Customer_ID, Customers.Company_Name
FROM Customers
WHERE Customers.Customer_ID IN (
    SELECT Orders.Customer_ID
    FROM Orders
    JOIN Order_Details ON Orders.Order_ID = Order_Details.Order_ID
    JOIN Products ON Order_Details.Product_ID = Products.Product_ID
    GROUP BY Orders.Customer_ID
    HAVING COUNT(DISTINCT Products.Category_ID) = (
        SELECT COUNT(DISTINCT Category_ID)
        FROM Categories
    )
);

This query involves subqueries to check for customers who have ordered products from all categories.
The inner subquery retrieves the customers who have ordered products by joining the Orders, OrderDetails, and Products tables. It groups the orders by CustomerID and uses the COUNT(DISTINCT Products.CategoryID) to count the number of distinct categories of products each customer has ordered.
The outer query retrieves the customers whose CustomerID is in the result of the inner subquery. It checks if the count of distinct categories of products ordered by each customer is equal to the total count of distinct categories in the Categories table.